# 麻雀役判定モデル：評価指標解説

`results/exp1` 配下に保存されたCSVファイル群の構成と、各指標の解釈ガイドです。

---

## 1. 生成されるCSVファイル構成

| ファイル名             | 内容                                                 | 用途                                       |
| :--------------------- | :--------------------------------------------------- | :----------------------------------------- |
| **metrics_basic.csv**  | 役ごとの基本指標（Loss, Acc, Precision, Recall, F1） | 各役の得意・不得意を詳細に分析する         |
| **metrics_curves.csv** | 役ごとの曲線指標（ROC-AUC, PR-AUC）                  | 閾値に依存しないモデル自体の「地力」を測る |
| **mean_basic.csv**     | 全役の基本指標の平均値                               | モデル全体の総合的な精度を把握する         |
| **mean_curves.csv**    | 全役の曲線指標の平均値                               | 全体的な識別性能のトレンドを把握する       |

---

## 2. 各評価指標の意味と「理想的な値」

麻雀の役判定は「役があるか、ないか」の二値分類（Binary Classification）の結果です。

### 基本指標 (metrics_basic.csv)

これらは閾値 $0.5$ 固定での結果です。

- **Loss (BCE Loss)**:
  - **意味**: モデルが出力した確率と正解の「距離」。
  - **理想**: **0に近いほど良い。** \* **チェック**: 精度が高いのにLossが大きい場合、自信満々に間違えているケースがある。
- **Accuracy (正解率)**:
  - **意味**: 全データのうち、予測が当たった割合。
  - **理想**: **1.0に近いほど良い。**
  - **注意**: 麻雀では「その役がない」ケースが圧倒的に多いため、何もしなくてもAccuracyは高くなりやすい（空振りしてもAccは稼げる）。
- **Precision (適合率)**:
  - **意味**: モデルが「役あり」と判定したうち、本当に役があった割合。「予測の正確さ」。
  - **理想**: **高いほど「空振り」が少ない。**
- **Recall (再現率)**:
  - **意味**: 実際に役があるデータのうち、モデルが正しく「役あり」と判定できた割合。「見落としの少なさ」。
  - **理想**: **高いほど「役の見落とし」が少ない。**
- **F1-Score**:
  - **意味**: PrecisionとRecallの調和平均。
  - $$F1 = 2 \cdot \frac{Precision \cdot Recall}{Precision + Recall}$$
  - **理想**: **クラス不均衡な麻雀データにおいて、最も信頼すべき指標。** 両方のバランスが良いと高くなる。

### 曲線指標 (metrics_curves.csv)

閾値を $0.0 \dots 1.0$ まで動かした時の性能を凝縮した値です。

- **ROC-AUC**:
  - **意味**: 正解と不正解をどれだけ綺麗に「仕分け」できているか。
  - **目安**: 0.5でランダム、0.9以上なら非常に優秀。
- **PR-AUC (Average Precision)**:
  - **意味**: Precision-Recall曲線の下側の面積。
  - **重要性**: **麻雀AIにおいて最重要。** 役満や三暗刻のような「めったに現れない役」に対して、どれだけ鋭く反応できているかを示す。

---

## 3. 分析のポイント：何を目指すべきか

麻雀AIのアーキテクトとして、以下の視点でCSVをチェックしてくれ。

### ① 「立直」「タンヤオ」などの頻出役

- **期待**: F1-Scoreで **0.90以上** は欲しいところ。
- **対策**: ここが低いなら、モデルの容量不足か、特徴量（入力データ）の作り方が甘い可能性がある。

### ② 「三暗刻」「一気通貫」などの中堅役

- **期待**: F1-Scoreで **0.70〜0.80以上**。
- **対策**: Recallが低い（見落としが多い）場合は、学習データ内の役の偏りを補正（重み付けなど）する必要があるかもしれない。

### ③ 「役満」やレア役

- **期待**: ROC-AUCが **0.90以上** あれば、モデルの「素質」はある。
- **解釈**: データが少なすぎてF1-Scoreが低くても、PR-AUCが高ければ「惜しいところまで学習できている」と判断できる。

---

## 4. 理想的な評価結果のイメージ

| 役名   | Accuracy | F1-Score | PR-AUC | 判定                                         |
| :----- | :------- | :------- | :----- | :------------------------------------------- |
| 立直   | 0.98     | 0.95     | 0.97   | **完璧**（ほぼ見逃さない）                   |
| 三暗刻 | 0.99     | 0.75     | 0.85   | **良好**（稀に見逃すが正確）                 |
| 四暗刻 | 0.99     | 0.20     | 0.90   | **学習途上**（識別能力はあるが、慎重すぎる） |
